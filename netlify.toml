[build]
command = "npm run build"
publish = "build/client"

[dev]
command = "npm run dev"
framework = "vite"

[functions]
node_bundler = "esbuild"

# Gzip compression for better performance
[build.processing.html]
pretty_urls = true

[build.processing.css]
bundle = true
minify = true

[build.processing.js]
bundle = true
minify = true

# Set immutable caching for static files, because they have fingerprinted filenames
[[headers]]
for = "/build/*"
[headers.values]
"Cache-Control" = "public, max-age=31560000, immutable"

# Cache font files for 1 year
[[headers]]
for = "/fonts/*"
[headers.values]
"Cache-Control" = "public, max-age=31536000"

# Cache images for 1 month
[[headers]]
for = "/images/*"
[headers.values]
"Cache-Control" = "public, max-age=2592000"

# Security and performance headers for HTML pages
[[headers]]
for = "/*"
[headers.values]
"X-Frame-Options" = "DENY"
"X-XSS-Protection" = "1; mode=block"
"X-Content-Type-Options" = "nosniff"
"Referrer-Policy" = "strict-origin-when-cross-origin"
"Permissions-Policy" = "camera=(), microphone=(), geolocation=()"
